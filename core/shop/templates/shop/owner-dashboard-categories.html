{% extends "base.html" %}
{% load static %}

{% block meta %}
<meta charset="UTF-8">
<meta content='width=device-width, initial-scale=1.0, user-scalable=0' name='viewport'>
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta name="description" content="{{ store.meta_description }}">
<meta content="PicoSite" name="author">
<meta name="keywords" content="{{store.meta_keywords}}">
<meta name="robots" content="index, follow">
<link rel="canonical" href="{{store.get_canonical}}">

<!-- Open Graph tags -->
<meta property="og:title" content="{{store.meta_og_title}}">
<meta property="og:description" content="{{meta_og_description}}">
<meta property="og:image" content="{{store.get_logo_image}}" rel="shortcut icon" type="image/x-icon">
<meta property="og:url" content="{{store.get_canonical}}">
<meta property="og:type" content="website">

<!-- Twitter Card tags -->
<meta name="twitter:card" content="Summary Card with Large Image">
<meta name="twitter:title" content="{{store.meta_tc_title}}">
<meta name="twitter:description" content="{{store.meta_tc_description}}">
<meta name="twitter:image" content="{{store.get_logo_image}}">
{% endblock %}

{% block title %}دسته‌بندی محصولات{% endblock %}
{% block content %}

<div class="main-content app-content mt-0">
    <div class="side-app">

        <!-- CONTAINER -->
        <div class="main-container container-fluid">

            <!-- PAGE-HEADER -->
            <div class="page-header">
                <h1 class="page-title">داشبورد فروشندگی</h1>
                <div>
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'shop:owner_dashboard' %}">داشبورد فروشندگی</a></li>
                        <li aria-current="page" class="breadcrumb-item active">دسته‌بندی محصولات</li>
                    </ol>
                </div>
            </div>
            <!-- PAGE-HEADER END -->

            <!-- Row -->
            <div class="row">
                <div class="col-xl-3">
                    <div class="position-lg-relative w-100" id="scroll-stickybar">
                        <div class="card">
                            <div class="list-group list-group-transparent mb-0 mail-inbox pb-3">
                                <div class="mt-4 mx-4 mb-4 text-center">
                                    <a class="btn btn-primary btn-lg d-grid" href="{% url 'shop:index'  %}">مشاهده فروشگاه</a>
                                </div>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard'  %}">
                                    <span class="icons"><i class="fa fa-bars"></i></span>داشبورد
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4 {% if store.has_notif == True %}text-danger{% endif %}"
                                href="{% url 'shop:owner_dashboard_announcements'  %}">
                                    <span class="icons"><i class="fa fa-fa fa-bell {% if store.has_notif == True %}text-danger{% endif %}"></i></span> اطلاعیه‌ها
                                </a>
                                <a class="list-group-item d-flex align-items-center  mx-4"
                                   href="{% url 'shop:owner_dashboard_orders'  %}">
                                    <span class="icons"><i class="fa fa-shopping-bag"></i></span>سفارشات                                
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_products'  %}">
                                    <span class="icons"><i class="fa fa-cubes"></i></span> محصولات 
                                </a>
                                <a class="list-group-item d-flex align-items-center active mx-4"
                                   href="{% url 'shop:owner_dashboard_categories'  %}">
                                    <span class="icons"><i class="fa fa-th-large"></i></span> دسته‌بندی‌ها
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_filters'  %}">
                                    <span class="icons"><i class="fa fa-filter"></i></span> فیلترها 
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_edit_home'  %}">
                                    <span class="icons"><i class="fa fa-home"></i></span> نمای صفحه خانه
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_customers'  %}">
                                    <span class="icons"><i class="fa fa-user"></i></span> مشتریان
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_messages'  %}">
                                    <span class="icons"><i class="fa fa-envelope"></i></span> پیام‌ها
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_comments'  %}">
                                    <span class="icons"><i class="fa fa-comment"></i></span> دیدگاه‌ها
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_delivery'  %}">
                                    <span class="icons"><i class="fa fa-truck"></i></span> رویه‌های ارسال
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_coupons'  %}">
                                    <span class="icons"><i class="fa fa-usd"></i></span> کوپن‌های تخفیف
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_store_update'  %}">
                                    <span class="icons"><i class="fa fa-gear"></i></span> تنظیمات فروشگاه
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_blog'  %}">
                                    <span class="icons"><i class="fa fa-th"></i></span> وبلاگ
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_blog_category'  %}">
                                    <span class="icons"><i class="fa fa-th-list"></i></span> دسته‌بندی‌های پست‌ها
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:faq_create'  %}">
                                    <span class="icons"><i class="fa fa-question"></i></span> سوالات متداول
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_policies'  %}">
                                    <span class="icons"><i class="fa fa-info-circle"></i></span> قوانین و مقررات
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                   href="{% url 'shop:owner_dashboard_finance'  %}">
                                    <span class="icons"><i class="fa fa-money"></i></span> مالی
                                </a>
                                <a class="list-group-item d-flex align-items-center mx-4"
                                href="{% url 'shop:owner_dashboard_tutorials'  %}">
                                <span class="icons"><i class="fa fa-laptop"></i></span> آموزشی
                            </a>
                            <a class="list-group-item d-flex align-items-center mx-4"
                               href="{% url 'shop:owner_dashboard_ticket_list'  %}">
                                <span class="icons"><i class="fa fa-comments"></i></span> تیکت‌ها
                            </a>
                            <a class="list-group-item d-flex align-items-center mx-4"
                               href="{% url 'shop:owner_dashboard_meta'  %}">
                                <span class="icons"><i class="fa fa-fa fa-google"></i></span> متاتگ‌ها
                            </a>
                            </div>
                            
                        </div>
                    </div>
                </div>
                <div class="col-xl-9">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">افزودن دسته‌بندی</div>
                                </div>
                                <form method="post" action="{% url create_category_url  %}">
                                    {% csrf_token %}
                        
                                    <div class="card-body">
                                        
                                            <div class="row mb-12">
                                                <div class="col-md-12">
                                                    <input name="name" class="form-control" placeholder="نام دسته‌بندی" type="text">
                                                </div>
                                            </div>
                                            
                                            <!-- <div class="row mb-12">
                                                <div class="col-md-12 form-footer mt-4">
                                                    <input name="slug" class="form-control" placeholder="نامک" type="text">
                                                </div>
                                            </div>  -->
                                            
                                            <div class="row mb-12">
                                                <label class="col-md-12 form-label">آیا این دسته‌بندی زیردسته‌ی دسته‌بندی دیگری است؟ </label>
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label class="custom-control custom-checkbox mb-0">
                                                            <input class="custom-control-input" name="is_sub"
                                                                type="checkbox">
                                                            <span class="custom-control-label">اگر دسته‌بندی جدید زیردسته است این تیک را بزنید</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>  
                        
                                            <div class="row mb-12">
                                                <label class="custom-control custom-checkbox mb-0">دسته‌بندی مادر</label>
                                                <div class="col-md-12">
                                                
                                                    <select name="parent" class="form-control select2-show-search form-select" data-placeholder="انتخاب" type="text">
                                                    {% for category in categories %}
                                                    <option value="{{category.id}}">{{category.name}}</option>
                                                    {% endfor %}
                                                </select>
                                                </div>
                                            </div>
                                        <div class="form-footer mt-4">
                                            <button type="submit" class="login100-form-btn btn-primary">افزودن دسته‌بندی جدید</button>
                                        </div>
                                        <div><br></div>
                                    </div>
                                </form>
                        
                                    <div class="card-header">
                                            <h3 class="card-title">دسته‌بندی‌ها</h3>
                                        </div>
                                        <div class="card-body">
                                            <div class="table-responsive mt">
                                                <table class="table table-bordered text-nowrap mb-0" id="autofill-table">
                                                    <thead>
                                                    <tr>
                                                        <th>عنوان<span class="text text-white"></span></th>
                                                        <th>تصویر<span class="text text-white"></span></th>                  
                                                        <th>عملیات<span class="text text-white"></span></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                        
                                                        {% for category in categories %}
                                                            <tr>
                                                                <form method="post" action="{% url edit_category_url  category.id %}">
                                                                    {% csrf_token %}
                                                                    <td class="w-100">
                                                                        <div class="g-2 w-100">
                                                                        <div class="col-md-12 w-100">
                                                                            <input name="name" value="{{category.name}}" class="form-control w-100" placeholder="نام دسته‌بندی" type="text">
                                                                        </div>
                                                                        </div>
                                                                        <label class="custom-control custom-checkbox mb-0 form-footer mt-4">دسته‌بندی مادر {% if category.parent != None %} - مقدار فعلی: {{category.parent.name}} {% endif %}</label>
                                                                        <div class="col-md-12 w-100">
                                                                            <select name="parent" class="form-control select2-show-search form-select" data-placeholder="انتخاب" type="text">
                                                                                {% if category.is_sub == True %}
                                                                                <option value= "{{ category.parent.id }}" class="text-white">{{ category.parent.name }}</option>
                                                                                {% else %}
                                                                                <option value="0" class="text-white">انتخاب</option>
                                                                                {% endif %}
                                                                                {% for category in categories %}
                                                                                    <li><option value="{{ category.id }}">{{ category.name }}</option></li>
                                                                                {% endfor %}
                                                                        </select>
                                                                        </div>
                                                                    </td>

                                                                    <td>
                                                                        <div class="file-image-1">
                                                                            <a>
                                                                                <img alt="" class="br-5" src="{{category.get_image_url}}">
                                                                            </a>
                                                                            
                                                                        </div>
                                                                    </td>
                                                                    
                                                                    <td>
                                                                        <div class=" d-flex g-2">
                                                                            <button type="submit" class="login100-form-btn btn-primary">ذخیره</button> 
                                                                            
                                                                            <a href="{% url 'shop:delete_category'  category.id %}" class="btn text-danger bg-danger-transparent btn-icon py-1"
                                                                            data-bs-original-title="حذف" data-bs-toggle="tooltip"><span
                                                                                    class="bi bi-trash fs-16"></span></a>
                                                                        </div>
                                                                        <div class=" d-flex g-2 mt-4">
                                                                            <a class="btn btn-success login100-form-btn" href="{% url 'shop:image_bank'  'category' category.id %}">بروزرسانی تصویر</a> 
                                                                            <a href="{% url 'shop:delete_category_image'  category.id %}" class="btn text-danger bg-danger-transparent btn-icon py-1"
                                                                            data-bs-original-title="حذف تصویر" data-bs-toggle="tooltip"><span
                                                                                    class="bi bi-trash fs-16"></span></a>
                                                                            
                                                                            
                                                                        </div>
                                                                    </td>
                                                                </form>
                                                            </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        
                                    
                                    
                        
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- End Row -->

                </div>
            </div>
            <!-- ROW-1 CLOSED -->
        </div>
        <!-- CONTAINER CLOSED -->

    </div>
</div>
<!--app-content closed-->
    
{% endblock %}

{% block js %}
<script src="{% static 'assets/plugins/datatable/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'assets/plugins/datatable/js/dataTables.bootstrap5.js' %}"></script>
<script src="{% static 'assets/js/autofill-table.js' %}"></script>
<script src="{% static 'assets/plugins/select2/select2.full.min.js' %}"></script>
<script src="{% static 'assets/js/select2.js' %}"></script>



{% endblock %}